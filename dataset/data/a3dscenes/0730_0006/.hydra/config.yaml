machine:
  root_data_dir: ../../dataset/data
  mapanything_dataset_metadata_dir: ../../dataset/metadata
  root_pretrained_checkpoints_dir: ./checkpoints
  root_experiments_dir: ./experiments
  root_uniception_pretrained_checkpoints_dir: ./uniception_checkpoints
  external_benchmark_data_root_data_dir: ../../dataset/data/rmvd_mvs_benchmark/rmvd_test_data
model:
  model_str: mapanything
  model_config:
    pretrained_checkpoint_path: null
    load_specific_pretrained_submodules: false
    specific_pretrained_submodules: []
    name: mapanything
    encoder_config: ${model.encoder}
    info_sharing_config: ${model.info_sharing}
    pred_head_config: ${model.pred_head}
    geometric_input_config: ${model.task}
  pretrained: ${root_experiments_dir}/mapanything/training/mapa_finetuning_depth_completion_v3/checkpoint-last.pth
  data_norm_type: ${model.encoder.data_norm_type}
  torch_hub_force_reload: false
  encoder:
    encoder_str: dinov2
    name: dinov2_large
    data_norm_type: dinov2
    size: large
    with_registers: false
    uses_torch_hub: true
    gradient_checkpointing: false
  info_sharing:
    model_type: alternating_attention
    model_return_type: intermediate_features
    custom_positional_encoding: null
    module_args:
      name: aat_24_layers_ifr
      indices:
      - 11
      - 17
      norm_intermediate: true
      size: 24_layers
      depth: 24
      distinguish_ref_and_non_ref_views: true
      gradient_checkpointing: false
  pred_head:
    adaptor_config:
      input_dim: 6
      scene_rep_dim: 4
      type: raydirs+depth+pose+confidence+mask
      scene_rep_type: raydirs+depth+pose
      dense_pred_init_dict:
        name: raydirs+depth+pose+confidence+mask+scale
        ray_directions_mode: linear
        ray_directions_normalize_to_unit_sphere: true
        ray_directions_normalize_to_unit_image_plane: false
        ray_directions_vmin: ${special_float:"-inf"}
        ray_directions_vmax: ${special_float:"inf"}
        ray_directions_clamp_min_of_z_dir: false
        ray_directions_z_dir_min: ${special_float:"-inf"}
        depth_mode: exp
        depth_vmin: 0
        depth_vmax: ${special_float:"inf"}
        confidence_type: exp
        confidence_vmin: 1
        confidence_vmax: ${special_float:"inf"}
      pose_pred_init_dict:
        name: raydirs+depth+pose+confidence+mask+scale
        cam_trans_mode: linear
        cam_trans_vmin: ${special_float:"-inf"}
        cam_trans_vmax: ${special_float:"inf"}
        quaternions_mode: linear
        quaternions_normalize: true
        quaternions_vmin: ${special_float:"-inf"}
        quaternions_vmax: ${special_float:"inf"}
      scale_pred_init_dict:
        name: raydirs+depth+pose+confidence+mask+scale
        mode: exp
        vmin: 1.0e-08
        vmax: ${special_float:"inf"}
    type: dpt+pose
    feature_head:
      feature_dim: 256
      hooks:
      - 0
      - 1
      - 2
      - 3
      checkpoint_gradient: ${model.pred_head.gradient_checkpointing}
    regressor_head:
      output_dim: ${model.pred_head.adaptor_config.input_dim}
      checkpoint_gradient: ${model.pred_head.gradient_checkpointing}
    pose_head:
      num_resconv_block: 2
      rot_representation_dim: 4
    scale_head:
      output_dim: 1
    adaptor_type: ${model.pred_head.adaptor_config.type}
    dpt_adaptor: ${model.pred_head.adaptor_config.dense_pred_init_dict}
    pose_adaptor: ${model.pred_head.adaptor_config.pose_pred_init_dict}
    scale_adaptor: ${model.pred_head.adaptor_config.scale_pred_init_dict}
    gradient_checkpointing: false
  task:
    ray_dirs_encoder_config:
      name: ray_dirs_encoder
      in_chans: 3
      encoder_str: dense_rep_encoder
      apply_pe: false
    depth_encoder_config:
      name: depth_encoder
      in_chans: 1
      encoder_str: dense_rep_encoder
      apply_pe: false
    cam_rot_encoder_config:
      name: cam_rot_quats_encoder
      in_chans: 4
      encoder_str: global_rep_encoder
    cam_trans_encoder_config:
      name: cam_trans_encoder
      in_chans: 3
      encoder_str: global_rep_encoder
    scale_encoder_config:
      name: scale_encoder
      in_chans: 1
      encoder_str: global_rep_encoder
    overall_prob: 1
    dropout_prob: 0
    ray_dirs_prob: 1
    depth_prob: 1
    cam_prob: 1
    sparse_depth_prob: 1
    sparsification_removal_percent: 0.9
    depth_scale_norm_all_prob: 0
    pose_scale_norm_all_prob: 0
    mvs_mask_prob: 0.9
    depth_completion:
      mvs_mask_prob: 1.0
      sparse_depth_prob: 1.0
      sparsification_removal_percent: 0.5
root_data_dir: ${machine.root_data_dir}
root_experiments_dir: ${machine.root_experiments_dir}
output_dir: ${hydra:run.dir}
batch_size: 8
save_exr: true
save_png: false
resolution:
- 1022
- 630
align_mode: affine
depth_thresholds:
- 0.5
- 1.0
- 2.0
- 5.0
dataset_root: ${root_data_dir}/a3dscenes
scene_name: '0730_0006'
modalities:
- image
- depth
- mask
seed: 0
disable_cudnn_benchmark: true
amp: 1
amp_dtype: bf16
transform: imgnorm
data_norm_type: dinov2
